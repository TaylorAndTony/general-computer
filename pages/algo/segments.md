# 应用程序分段

[https://zhuanlan.zhihu.com/p/348026261](https://zhuanlan.zhihu.com/p/348026261)

![](https://pic1.zhimg.com/70/v2-db1beae537441e72682b5932b97770b0_1440w.awebp?source=172ae18b&biz_tag=Post)

代码段（.text）是可执行指令的集合；

数据段(.data)和 BSS 段(.bss)是数据的集合，其中.data 表示已经初始化的数据，.bss 表示未初始化的数据。

从可执行程序的角度来说，如果一个数据未被初始化，就不需要为其分配空间，所以.data 和.bss 的区别就是 .bss 并不占用可执行文件的大小，仅仅记录需要用多少空间来存储这些未初始化的数据，而不分配实际空间。

一个可执行程序至少包含：代码段 + 数据段 + BSS 段

一个可执行二进制程序（在 linux 下为一个进程单元），在存储时（没有加载到内存运行），至少拥有**三个部分**，分别是代码段(text)、数据段(data)、和BSS 段。

这三个部分一起组成了可执行程序（可能还有其他的段，和平台相关）

当应用程序运行时（运行态），此时需要另外两个域：**堆和栈**。正在运行的程序：代码段 + 数据段 + BSS 段 + 堆 + 栈。

| 段名         | 存储属性                                                     | 内存分配 |
| ------------ | ------------------------------------------------------------ | -------- |
| 代码段 .text | 存放可执行程序的指令，存储态和运行态都有                     | 静态     |
| 数据段 .data | 存放已初始化（非零初始化的全局变量和静态局部变量）的数据，存储态和运行态都有 | 静态     |
| bss段 .bss   | 存放未初始化（未初始化或者0初始化的全局变量和静态局部变量）的数据，存储态和运行态都有 | 静态     |
| 堆 heap      | 动态分配内存，需要通过malloc手动申请，free手动释放，适合大块内存。容易造成内存泄漏和内存碎片。运行态才有。 | 动态     |
| 栈 stack     | 存放函数局部变量和参数以及返回值，函数返回后，由操作系统立即回收。栈空间不大，使用不当容易栈溢出。运行态才有 | 静态     |
